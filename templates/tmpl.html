<script type="text/x-tmpl" id="tmpl-graphs">
    {%  $.each(o.cols, function(i, el) { 
            el.total = o.total;
            el.i = i;
            include('tmpl-graph-column', el); 
        }); %}
</script>
<script type="text/x-tmpl" id="tmpl-graph-column">
    <div id="item-{%=o.i%}" class="item" data-title="{%=o.title%}">
        {%  var arr = [
            {"t": "Good", "c": "green", "v": o.results.filter((i) => i.answer == "1").length},
            {"t": "Unsure", "c": "orange", "v": o.results.filter((i) => i.answer == "0").length}, 
            {"t": "No response", "c": "gray", "v": o.results.filter((i) => i.answer == "-1").length}
        ];
        if (o.results.length == 0) {
            arr = [{"t": "No response", "c": "gray", "v": o.total}];
        }
    $.each(arr, function(e, el) { 
        el.x = o.total;
        include('tmpl-graph-line', el); 
    }); 
%}
    </div>
</script>
<script type="text/x-tmpl" id="tmpl-graph-line">
    {% var p = o.x == 0 ? 1 : (o.v / o.x) * 100; %}
    <div class="item_{%=o.c%} tt" style="flex: {%=p%};" title="{%=(o.t != ''? o.t+": " : "")%}{%=Math.round(p, 2)%} % ({%=o.v%})"></div>
</script>
<script type="text/x-tmpl" id="tmpl-last-saved">
    <i class="fas fa-users"></i>&nbsp;
    Students: <span>{%=o.participants%}</span>
    &nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;
    <i class="far fa-clock"></i>&nbsp;
    {% if (o.updated != '') { %}Last updated: <span>{%=moment(o.updated).calendar()%}</span>{% } else { %}Last saved: <span>Never</span> {% } %}
</script>
<script type="text/x-tmpl" id="tmpl-state">
<div id="state" class="fa-3x">
    <div>
        {% switch(o.state) { 
            case 0: %}<img src="{%=o.svg%}" width="40" alt=""> Loading course information ... {% break; 
            case 1: %}<a href="#">The course information is empty <small>(click to retry)</small>.</a>{% break; 
            case 2: %}<span class="error">Course information could not be loaded.</span>{% break; 
        } %}
    </div>
</div>
</script>
